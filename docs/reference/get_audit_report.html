<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get audit report — get_audit_report • EDIutils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get audit report — get_audit_report" />
<meta property="og:description" content="Get audit report" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EDIutils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/search_and_access.html">Search and Access Data</a>
    </li>
    <li>
      <a href="../articles/publish_data.html">Evaluate and Upload Data</a>
    </li>
    <li>
      <a href="../articles/retrieve_downloads.html">Retrieve Download Metrics</a>
    </li>
    <li>
      <a href="../articles/retrieve_citations.html">Retrieve Citation Metrics</a>
    </li>
    <li>
      <a href="../articles/tests_requiring_authentication.html">Tests Requiring Authentication</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EDIorg/EDIutils/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get audit report</h1>
    <small class="dont-index">Source: <a href='https://github.com/EDIorg/EDIutils/blob/master/R/get_audit_report.R'><code>R/get_audit_report.R</code></a></small>
    <div class="hidden name"><code>get_audit_report.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get audit report</p>
    </div>

    <pre class="usage"><span class='fu'>get_audit_report</span><span class='op'>(</span><span class='va'>query</span>, env <span class='op'>=</span> <span class='st'>"production"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query</th>
      <td><p>(character) Query (see details below)</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>(character) Repository environment. Can be: "production", "staging", or "development".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(xml_document) An XML list of zero or more audit records matching the query parameters as specified in the request (see details below).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Query parameters are specified as key=value pairs, multiple pairs must be delimited with ampersands (&amp;), and only a single value should be specified for a particular key. The following query parameter keys are allowed:</p>
<ul>
<li><p>category - Can be: debug, info, error, warn</p></li>
<li><p>service - Any of the EDI data repository services</p></li>
<li><p>serviceMethod - Any of the EDI data repository service Resource class JAX-RS methods</p></li>
<li><p>user - Any user</p></li>
<li><p>group - Any group</p></li>
<li><p>authSystem - A valid auth system identifier</p></li>
<li><p>status - A valid HTTP Response Code</p></li>
<li><p>resourceId - An EDI data repository resource identifier, e.g. https://pasta.lternet.edu/package/eml/knb-lter-and/2719/6, or a thereof (see details below)</p></li>
<li><p>fromTime - An ISO8601 timestamp</p></li>
<li><p>toTime - An ISO8601 timestamp</p></li>
<li><p>limit - A positive whole number</p></li>
</ul>

<p>The query parameters fromTime and optionally toTime should be used to indicate a time span. When toTime is absent, the report will consist of all matching records up to the current time. Either of these parameters may only be used once. The query parameter limit sets an upper limit on the number of audit records returned. For example, "limit=1000". The query parameter resourceId will match any audit log entry whose resourceId value contains the specified string value. Thus, a query parameter of "resourceId=knb-lter-and" will match any audit log entry whose resourceId value contains the substring "knb-lter-and", while a query parameter of "resourceId=knb-lter-and/2719/6" will match any audit log entry whose resourceId value contains the substring "knb-lter-and/2719/6".</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>User authentication is required (see <code><a href='login.html'>login()</a></code>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  
<span class='fu'><a href='login.html'>login</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># Get audit report for data reads between 2021-12-01 and 2021-12-02</span>
<span class='va'>auditReport</span> <span class='op'>&lt;-</span> <span class='fu'>get_audit_report</span><span class='op'>(</span>
 query <span class='op'>=</span> <span class='st'>"serviceMethod=readDataEntity&amp;fromTime=2021-12-01&amp;toTime=2021-12-02"</span><span class='op'>)</span>
<span class='va'>auditReport</span>
<span class='co'>#&gt; [1] &lt;auditRecord&gt;\n  &lt;oid&gt;121606334&lt;/oid&gt;\n  &lt;entryTime&gt;2021-12-01T ...</span>
<span class='co'>#&gt; [2] &lt;auditRecord&gt;\n  &lt;oid&gt;121606349&lt;/oid&gt;\n  &lt;entryTime&gt;2021-12-01T ...</span>
<span class='co'>#&gt; [3] &lt;auditRecord&gt;\n  &lt;oid&gt;121606465&lt;/oid&gt;\n  &lt;entryTime&gt;2021-12-01T ...</span>
<span class='co'>#&gt; [4] &lt;auditRecord&gt;\n  &lt;oid&gt;121606937&lt;/oid&gt;\n  &lt;entryTime&gt;2021-12-01T ...</span>
<span class='co'>#&gt; [5] &lt;auditRecord&gt;\n  &lt;oid&gt;121607211&lt;/oid&gt;\n  &lt;entryTime&gt;2021-12-01T ...</span>
<span class='co'>#&gt; ...</span>

<span class='co'># Get the first audit record</span>
<span class='fu'>xml2</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/xml_find_all.html'>xml_find_first</a></span><span class='op'>(</span><span class='va'>auditReport</span>, <span class='st'>".//auditRecord"</span><span class='op'>)</span>
<span class='co'>#&gt; {xml_node}</span>
<span class='co'>#&gt; &lt;auditRecord&gt;</span>
<span class='co'>#&gt; [1] &lt;oid&gt;121606334&lt;/oid&gt;</span>
<span class='co'>#&gt; [2] &lt;entryTime&gt;2021-12-01T00:00:07&lt;/entryTime&gt;</span>
<span class='co'>#&gt; [3] &lt;category&gt;warn&lt;/category&gt;</span>
<span class='co'>#&gt; [4] &lt;service&gt;DataPackageManager-1.0&lt;/service&gt;</span>
<span class='co'>#&gt; [5] &lt;serviceMethod&gt;readDataEntity&lt;/serviceMethod&gt;</span>
<span class='co'>#&gt; [6] &lt;responseStatus&gt;401&lt;/responseStatus&gt;</span>
<span class='co'>#&gt; [7] &lt;resourceId/&gt;</span>
<span class='co'>#&gt; [8] &lt;user&gt;robot&lt;/user&gt;</span>
<span class='co'>#&gt; [9] &lt;userAgent&gt;null&lt;/userAgent&gt;</span>
<span class='co'>#&gt; [10] &lt;groups/&gt;</span>
<span class='co'>#&gt; [11] &lt;authSystem&gt;https://pasta.edirepository.org/authentication&lt;/aut ...</span>
<span class='co'>#&gt; [12] &lt;entryText&gt;Robots are not authorized access to data objects. Ro ...</span>

<span class='fu'><a href='logout.html'>logout</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Colin Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


